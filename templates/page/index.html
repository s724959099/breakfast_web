{% extends "main.html" %}
{% block body %}
    <v-app id="#app">
        <v-toolbar dark color="primary">
            <v-toolbar-side-icon></v-toolbar-side-icon>
            <v-toolbar-title class="white--text">打卡系統</v-toolbar-title>
        </v-toolbar>
        <v-content v-cloak>
            <v-container>
                <v-card v-for="item in users"
                        class="mb-5"
                >
                    <v-card-title class="card-title">
                        ${item.name}
                    </v-card-title>
                    <v-card-text>
                        <div class="row">
                            最後上下班時間
                        </div>
                        <div class="row between-xs">
                            <span>上班：</span>
                            <span class="time red--text lighten-1">
                                ${try_it(item.work_dates_instance,'from_time')}
                            </span>
                            <span>下班：</span>
                            <span class="time red--text lighten-1">
                                ${try_it(item.work_dates_instance,'to_time')}
                            </span>
                        </div>
                        <m-btn class="fill-width mt-20px"
                               :color="is_work(item)?'error':'success'"
                               >
                            ${work_btn_status(item)}
                        </m-btn>
                    </v-card-text>
                </v-card>
            </v-container>
        </v-content>
        </div>

    </v-app>

{% endblock %}
{% block script %}
    <script>
        new Vue({
            el: '#app',
            data: {
                users: []
            },
            methods: {
                is_work(item){
                    return this.try_it(item.work_dates_instance, 'from_time') !== ''
                },
                work_btn_status(item){
                    return this.is_work(item)
                        ? '下班' : '上班'
                },
                try_it(item, arg){
                    try {
                        return item[arg]
                    } catch (e) {
                        return ""
                    }
                }
            },
            mounted(){
                axios.get(get_url('/users'))
                    .then((res) => {
                        this.users = res.data
                    })
            }
        })
    </script>
{% endblock %}
